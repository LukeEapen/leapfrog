<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Jira Ticket Created Successfully</title>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <style>
    body {
      background-color: #2f323a;
      color: #fff;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      margin: 0;
      padding: 0;
      min-height: 100vh;
    }
    .main-container {
      max-width: 800px;
      margin: 20px auto;
      background: #fff;
      border: none;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      overflow: hidden;
    }
    .success-header {
      background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
      color: white;
      padding: 20px;
      text-align: center;
      font-size: 24px;
      font-weight: 600;
    }
    .success-icon {
      font-size: 48px;
      margin-bottom: 10px;
    }
    .content-container {
      background: white;
      margin: 0;
      padding: 28px;
      color: #000;
    }
    .ticket-info {
      background: #f8f9fa;
      border: 1px solid #dee2e6;
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 24px;
      text-align: center;
    }
    .ticket-key {
      font-size: 32px;
      font-weight: bold;
      color: #d0021b;
      margin-bottom: 10px;
    }
    .ticket-url {
      margin-bottom: 20px;
    }
    .ticket-link {
      display: inline-block;
      background: #007bff;
      color: white;
      padding: 12px 24px;
      border-radius: 6px;
      text-decoration: none;
      font-weight: 600;
      transition: all 0.3s ease;
    }
    .ticket-link:hover {
      background: #0056b3;
      color: white;
      text-decoration: none;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0, 123, 255, 0.3);
    }
    .story-summary {
      background: #fff;
      border: 1px solid #ddd;
      border-radius: 6px;
      padding: 20px;
      margin-bottom: 20px;
    }
    .summary-title {
      font-size: 18px;
      font-weight: 600;
      margin-bottom: 12px;
      color: #333;
      border-bottom: 2px solid #d0021b;
      padding-bottom: 8px;
    }
    .summary-item {
      margin-bottom: 12px;
      padding: 8px 0;
      border-bottom: 1px solid #f0f0f0;
    }
    .summary-label {
      font-weight: 600;
      color: #666;
      margin-right: 8px;
    }
    .criteria-list {
      list-style: none;
      padding: 0;
      margin: 12px 0;
    }
    .criteria-list li {
      padding: 8px 16px;
      background: #f8f9fa;
      margin-bottom: 4px;
      border-radius: 4px;
      border-left: 3px solid #28a745;
      position: relative;
      padding-left: 32px;
    }
    .criteria-list li:before {
      content: "‚úì";
      position: absolute;
      left: 12px;
      color: #28a745;
      font-weight: bold;
    }
    .action-buttons {
      display: flex;
      gap: 16px;
      justify-content: center;
      margin-top: 24px;
      flex-wrap: wrap;
    }
    .action-btn {
      padding: 12px 24px;
      border: none;
      border-radius: 6px;
      font-weight: 600;
      cursor: pointer;
      text-decoration: none;
      transition: all 0.3s ease;
      display: inline-block;
      text-align: center;
      min-width: 160px;
    }
    .btn-primary {
      background: #d0021b;
      color: white;
    }
    .btn-primary:hover {
      background: #a0011a;
      color: white;
      text-decoration: none;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(208, 2, 27, 0.3);
    }
    .btn-secondary {
      background: #6c757d;
      color: white;
    }
    .btn-secondary:hover {
      background: #545b62;
      color: white;
      text-decoration: none;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(108, 117, 125, 0.3);
    }
    .btn-outline {
      background: transparent;
      color: #007bff;
      border: 2px solid #007bff;
    }
    .btn-outline:hover {
      background: #007bff;
      color: white;
      text-decoration: none;
      transform: translateY(-2px);
    }
    
    /* Responsive Design */
    @media (max-width: 768px) {
      .main-container {
        margin: 10px;
      }
      .content-container {
        padding: 20px;
      }
      .action-buttons {
        flex-direction: column;
        align-items: center;
      }
      .action-btn {
        width: 100%;
        max-width: 300px;
      }
    }
  </style>
</head>
<body>
  <div class="main-container">
    <!-- Success Header -->
    <div class="success-header">
      <div class="success-icon">üéâ</div>
      <div>{{ success_message or 'Jira Ticket Created Successfully!' }}</div>
    </div>

    <!-- Main Content -->
    <div class="content-container">
      <!-- Ticket Information -->
      <div class="ticket-info">
        <div class="ticket-key">{{ ticket_key or 'SCRUM-XXX' }}</div>
        <div class="ticket-url">
          <a href="{{ ticket_url or '#' }}" target="_blank" class="ticket-link">
            üîó View Ticket in Jira
          </a>
        </div>
        <p style="color: #666; margin: 0; font-size: 14px;">
          Click the link above to view your ticket in Jira
        </p>
      </div>

      <!-- Story Summary -->
      <div class="story-summary">
        <div class="summary-title">üìã User Story Summary</div>
        
        <div class="summary-item">
          <span class="summary-label">Epic:</span>
          <span>{{ epic_title or 'N/A' }}</span>
        </div>
        
        <div class="summary-item">
          <span class="summary-label">Story Name:</span>
          <span>{{ summary or 'N/A' }}</span>
        </div>
        
        <div class="summary-item">
          <span class="summary-label">Priority:</span>
          <span style="color: #d0021b; font-weight: 600;">{{ priority or 'High' }}</span>
        </div>
        
        <div class="summary-item">
          <span class="summary-label">Responsible Systems:</span>
          <span>{{ responsible_systems or 'N/A' }}</span>
        </div>
        
        {% if description %}
        <div class="summary-item">
          <span class="summary-label">Description:</span>
          <div style="margin-top: 8px; padding: 12px; background: #f8f9fa; border-radius: 4px; border-left: 3px solid #007bff;">
            {{ description }}
          </div>
        </div>
        {% endif %}
        
        {% if acceptance_criteria %}
        <div class="summary-item">
          <span class="summary-label">Acceptance Criteria:</span>
          <ul class="criteria-list">
            {% for criterion in acceptance_criteria %}
            <li>{{ criterion }}</li>
            {% endfor %}
          </ul>
        </div>
        {% endif %}
        
        {% if tagged_requirements %}
        <div class="summary-item">
          <span class="summary-label">Tagged Requirements:</span>
          <ul class="criteria-list">
            {% for requirement in tagged_requirements %}
            <li>{{ requirement }}</li>
            {% endfor %}
          </ul>
        </div>
        {% endif %}
      </div>

      <!-- Action Buttons -->
      <div class="action-buttons">
        <a href="{{ ticket_url or '#' }}" target="_blank" class="action-btn btn-primary">
          üîó Open in Jira
        </a>
        <a href="/epic-results" class="action-btn btn-secondary">
          ‚Üê Back to Epics
        </a>
        <a href="/" class="action-btn btn-outline">
          üè† Start New Project
        </a>
      </div>
    </div>
  </div>

  <script>
    // Auto-open Jira ticket in new tab after 2 seconds
    setTimeout(function() {
      const ticketUrl = "{{ ticket_url or '' }}";
      if (ticketUrl && ticketUrl !== '#') {
        console.log('Auto-opening Jira ticket:', ticketUrl);
        // Uncomment the line below if you want auto-opening
        // window.open(ticketUrl, '_blank');
      }
    }, 2000);
    
    // Copy ticket key to clipboard function
    function copyTicketKey() {
      const ticketKey = "{{ ticket_key or '' }}";
      if (ticketKey) {
        navigator.clipboard.writeText(ticketKey).then(function() {
          alert('Ticket key copied to clipboard: ' + ticketKey);
        }, function(err) {
          console.error('Could not copy text: ', err);
        });
      }
    }
    
    // Add click handler to ticket key for copying
    document.addEventListener('DOMContentLoaded', function() {
      const ticketKeyElement = document.querySelector('.ticket-key');
      if (ticketKeyElement) {
        ticketKeyElement.style.cursor = 'pointer';
        ticketKeyElement.title = 'Click to copy ticket key';
        ticketKeyElement.addEventListener('click', copyTicketKey);
      }
    });
  </script>
</body>
</html>
